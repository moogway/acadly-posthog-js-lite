"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});var _exportNames={PostHogCore:true,utils:true,LZString:true};Object.defineProperty(exports,"LZString",{enumerable:true,get:function get(){return _lzString.LZString;}});exports.utils=exports.PostHogCore=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _types=require("./types");Object.keys(_types).forEach(function(key){if(key==="default"||key==="__esModule")return;if(Object.prototype.hasOwnProperty.call(_exportNames,key))return;if(key in exports&&exports[key]===_types[key])return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _types[key];}});});var _utils=_interopRequireWildcard(require("./utils"));exports.utils=_utils;var _lzString=require("./lz-string");var _eventemitter=require("./eventemitter");function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{"default":obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj);}return newObj;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}var PostHogCore=function(){function PostHogCore(apiKey,options){var _this=this;(0,_classCallCheck2["default"])(this,PostHogCore);var _a,_b,_c,_d,_e,_f;this.flagCallReported={};this._events=new _eventemitter.SimpleEventEmitter();(0,_utils.assert)(apiKey,"You must pass your PostHog project's api key.");this.apiKey=apiKey;this.host=(0,_utils.removeTrailingSlash)((options===null||options===void 0?void 0:options.host)||'https://app.posthog.com');this.flushAt=(options===null||options===void 0?void 0:options.flushAt)?Math.max(options===null||options===void 0?void 0:options.flushAt,1):20;this.flushInterval=(_a=options===null||options===void 0?void 0:options.flushInterval)!==null&&_a!==void 0?_a:10000;this.captureMode=(options===null||options===void 0?void 0:options.captureMode)||'form';this.sendFeatureFlagEvent=(_b=options===null||options===void 0?void 0:options.sendFeatureFlagEvent)!==null&&_b!==void 0?_b:true;this._optoutOverride=(options===null||options===void 0?void 0:options.enable)===false;this._retryOptions={retryCount:(_c=options===null||options===void 0?void 0:options.fetchRetryCount)!==null&&_c!==void 0?_c:3,retryDelay:(_d=options===null||options===void 0?void 0:options.fetchRetryDelay)!==null&&_d!==void 0?_d:3000};this.requestTimeout=(_e=options===null||options===void 0?void 0:options.requestTimeout)!==null&&_e!==void 0?_e:10;this._sessionExpirationTimeSeconds=(_f=options===null||options===void 0?void 0:options.sessionExpirationTimeSeconds)!==null&&_f!==void 0?_f:1800;if((options===null||options===void 0?void 0:options.preloadFeatureFlags)!==false){(0,_utils.safeSetTimeout)(function(){void _this.reloadFeatureFlagsAsync();},1);}}(0,_createClass2["default"])(PostHogCore,[{key:"getCommonEventProperties",value:function getCommonEventProperties(){var featureFlags=this.getFeatureFlags();var featureVariantProperties={};if(featureFlags){for(var _i=0,_Object$entries=Object.entries(featureFlags);_i<_Object$entries.length;_i++){var _Object$entries$_i=(0,_slicedToArray2["default"])(_Object$entries[_i],2),feature=_Object$entries$_i[0],variant=_Object$entries$_i[1];featureVariantProperties["$feature/".concat(feature)]=variant;}}return _objectSpread({$lib:this.getLibraryId(),$lib_version:this.getLibraryVersion(),$active_feature_flags:featureFlags?Object.keys(featureFlags):undefined},featureVariantProperties);}},{key:"setupBootstrap",value:function setupBootstrap(options){var _a,_b,_c,_d;if((_a=options===null||options===void 0?void 0:options.bootstrap)===null||_a===void 0?void 0:_a.distinctId){if((_b=options===null||options===void 0?void 0:options.bootstrap)===null||_b===void 0?void 0:_b.isIdentifiedId){this.setPersistedProperty(_types.PostHogPersistedProperty.DistinctId,options.bootstrap.distinctId);}else{this.setPersistedProperty(_types.PostHogPersistedProperty.AnonymousId,options.bootstrap.distinctId);}}if((_c=options===null||options===void 0?void 0:options.bootstrap)===null||_c===void 0?void 0:_c.featureFlags){var activeFlags=Object.keys(((_d=options.bootstrap)===null||_d===void 0?void 0:_d.featureFlags)||{}).filter(function(flag){var _a,_b;return!!((_b=(_a=options.bootstrap)===null||_a===void 0?void 0:_a.featureFlags)===null||_b===void 0?void 0:_b[flag]);}).reduce(function(res,key){var _a,_b;return res[key]=((_b=(_a=options.bootstrap)===null||_a===void 0?void 0:_a.featureFlags)===null||_b===void 0?void 0:_b[key])||false,res;},{});this.setKnownFeatureFlags(activeFlags);}}},{key:"props",get:function get(){if(!this._props){this._props=this.getPersistedProperty(_types.PostHogPersistedProperty.Props);}return this._props||{};},set:function set(val){this._props=val;}},{key:"clearProps",value:function clearProps(){this.props=undefined;}},{key:"optedOut",get:function get(){var _a,_b;return(_b=(_a=this.getPersistedProperty(_types.PostHogPersistedProperty.OptedOut))!==null&&_a!==void 0?_a:this._optoutOverride)!==null&&_b!==void 0?_b:false;}},{key:"optIn",value:function optIn(){this.setPersistedProperty(_types.PostHogPersistedProperty.OptedOut,false);}},{key:"optOut",value:function optOut(){this.setPersistedProperty(_types.PostHogPersistedProperty.OptedOut,true);}},{key:"on",value:function on(event,cb){return this._events.on(event,cb);}},{key:"reset",value:function reset(propertiesToKeep){var allPropertiesToKeep=[_types.PostHogPersistedProperty.Queue].concat((0,_toConsumableArray2["default"])(propertiesToKeep||[]));this.clearProps();for(var _i2=0,_Object$keys=Object.keys(_types.PostHogPersistedProperty);_i2<_Object$keys.length;_i2++){var key=_Object$keys[_i2];if(!allPropertiesToKeep.includes(_types.PostHogPersistedProperty[key])){this.setPersistedProperty(_types.PostHogPersistedProperty[key],null);}}}},{key:"debug",value:function debug(){var enabled=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var _a;(_a=this.removeDebugCallback)===null||_a===void 0?void 0:_a.call(this);if(enabled){this.removeDebugCallback=this.on('*',function(event,payload){return console.log('PostHog Debug',event,payload);});}}},{key:"buildPayload",value:function buildPayload(payload){return{distinct_id:payload.distinct_id||this.getDistinctId(),event:payload.event,properties:_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.props),payload.properties||{}),this.getCommonEventProperties()),{},{$session_id:this.getSessionId()})};}},{key:"getSessionId",value:function getSessionId(){var sessionId=this.getPersistedProperty(_types.PostHogPersistedProperty.SessionId);var sessionTimestamp=this.getPersistedProperty(_types.PostHogPersistedProperty.SessionLastTimestamp)||0;if(!sessionId||Date.now()-sessionTimestamp>this._sessionExpirationTimeSeconds*1000){sessionId=(0,_utils.generateUUID)(globalThis);this.setPersistedProperty(_types.PostHogPersistedProperty.SessionId,sessionId);}this.setPersistedProperty(_types.PostHogPersistedProperty.SessionLastTimestamp,Date.now());return sessionId;}},{key:"resetSessionId",value:function resetSessionId(){this.setPersistedProperty(_types.PostHogPersistedProperty.SessionId,null);}},{key:"getAnonymousId",value:function getAnonymousId(){var anonId=this.getPersistedProperty(_types.PostHogPersistedProperty.AnonymousId);if(!anonId){anonId=(0,_utils.generateUUID)(globalThis);this.setPersistedProperty(_types.PostHogPersistedProperty.AnonymousId,anonId);}return anonId;}},{key:"getDistinctId",value:function getDistinctId(){return this.getPersistedProperty(_types.PostHogPersistedProperty.DistinctId)||this.getAnonymousId();}},{key:"register",value:function register(properties){this.props=_objectSpread(_objectSpread({},this.props),properties);this.setPersistedProperty(_types.PostHogPersistedProperty.Props,this.props);}},{key:"unregister",value:function unregister(property){delete this.props[property];this.setPersistedProperty(_types.PostHogPersistedProperty.Props,this.props);}},{key:"identify",value:function identify(distinctId,properties){var previousDistinctId=this.getDistinctId();distinctId=distinctId||previousDistinctId;if(properties===null||properties===void 0?void 0:properties.$groups){this.groups(properties.$groups);}var payload=_objectSpread(_objectSpread({},this.buildPayload({distinct_id:distinctId,event:'$identify',properties:_objectSpread(_objectSpread({},properties||{}),{},{$anon_distinct_id:this.getAnonymousId()})})),{},{$set:properties});if(distinctId!==previousDistinctId){this.setPersistedProperty(_types.PostHogPersistedProperty.AnonymousId,previousDistinctId);this.setPersistedProperty(_types.PostHogPersistedProperty.DistinctId,distinctId);if(this.getFeatureFlags()){void this.reloadFeatureFlagsAsync();}}this.enqueue('identify',payload);return this;}},{key:"capture",value:function capture(event,properties){var forceSendFeatureFlags=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(properties===null||properties===void 0?void 0:properties.$groups){this.groups(properties.$groups);}if(forceSendFeatureFlags){this._sendFeatureFlags(event,properties);}else{var payload=this.buildPayload({event:event,properties:properties});this.enqueue('capture',payload);}return this;}},{key:"alias",value:function alias(_alias){var distinctId=this.getDistinctId();var payload=this.buildPayload({event:'$create_alias',properties:{distinct_id:distinctId,alias:_alias}});this.enqueue('alias',payload);return this;}},{key:"autocapture",value:function autocapture(eventType,elements){var properties=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var payload=this.buildPayload({event:'$autocapture',properties:_objectSpread(_objectSpread({},properties),{},{$event_type:eventType,$elements:elements})});this.enqueue('autocapture',payload);return this;}},{key:"groups",value:function groups(_groups){var existingGroups=this.props.$groups||{};this.register({$groups:_objectSpread(_objectSpread({},existingGroups),_groups)});if(Object.keys(_groups).find(function(type){return existingGroups[type]!==_groups[type];})&&this.getFeatureFlags()){void this.reloadFeatureFlagsAsync();}return this;}},{key:"group",value:function group(groupType,groupKey,groupProperties){this.groups((0,_defineProperty2["default"])({},groupType,groupKey));if(groupProperties){this.groupIdentify(groupType,groupKey,groupProperties);}return this;}},{key:"groupIdentify",value:function groupIdentify(groupType,groupKey,groupProperties){var payload={event:'$groupidentify',distinctId:"$".concat(groupType,"_").concat(groupKey),properties:_objectSpread({$group_type:groupType,$group_key:groupKey,$group_set:groupProperties||{}},this.getCommonEventProperties())};this.enqueue('capture',payload);return this;}},{key:"personProperties",value:function personProperties(properties){var existingProperties=this.getPersistedProperty(_types.PostHogPersistedProperty.PersonProperties)||{};this.setPersistedProperty(_types.PostHogPersistedProperty.PersonProperties,_objectSpread(_objectSpread({},existingProperties),properties));return this;}},{key:"groupProperties",value:function groupProperties(properties){var existingProperties=this.getPersistedProperty(_types.PostHogPersistedProperty.GroupProperties)||{};if(Object.keys(existingProperties).length!==0){Object.keys(existingProperties).forEach(function(groupType){existingProperties[groupType]=_objectSpread(_objectSpread({},existingProperties[groupType]),properties[groupType]);delete properties[groupType];});}this.setPersistedProperty(_types.PostHogPersistedProperty.GroupProperties,_objectSpread(_objectSpread({},existingProperties),properties));return this;}},{key:"decideAsync",value:function decideAsync(){var sendAnonDistinctId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this._decideResponsePromise){return this._decideResponsePromise;}return this._decideAsync(sendAnonDistinctId);}},{key:"_decideAsync",value:function(){var _decideAsync2=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(){var _this2=this;var sendAnonDistinctId,url,distinctId,groups,personProperties,groupProperties,fetchOptions,_args=arguments;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sendAnonDistinctId=_args.length>0&&_args[0]!==undefined?_args[0]:true;url="".concat(this.host,"/decide/?v=2");distinctId=this.getDistinctId();groups=this.props.$groups||{};personProperties=this.getPersistedProperty(_types.PostHogPersistedProperty.PersonProperties)||{};groupProperties=this.getPersistedProperty(_types.PostHogPersistedProperty.GroupProperties)||{};fetchOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:this.apiKey,distinct_id:distinctId,$anon_distinct_id:sendAnonDistinctId?this.getAnonymousId():undefined,groups:groups,person_properties:personProperties,group_properties:groupProperties})};this._decideResponsePromise=this.fetchWithRetry(url,fetchOptions).then(function(r){return r.json();}).then(function(res){if(res.featureFlags){_this2.setKnownFeatureFlags(res.featureFlags);}return res;})["finally"](function(){_this2._decideResponsePromise=undefined;});return _context.abrupt("return",this._decideResponsePromise);case 9:case"end":return _context.stop();}}},_callee,this);}));function _decideAsync(){return _decideAsync2.apply(this,arguments);}return _decideAsync;}()},{key:"setKnownFeatureFlags",value:function setKnownFeatureFlags(featureFlags){this.setPersistedProperty(_types.PostHogPersistedProperty.FeatureFlags,featureFlags);this._events.emit('featureflags',featureFlags);}},{key:"getFeatureFlag",value:function getFeatureFlag(key){var featureFlags=this.getFeatureFlags();if(!featureFlags){return undefined;}var response=featureFlags[key];if(response===undefined){response=false;}if(this.sendFeatureFlagEvent&&!this.flagCallReported[key]){this.flagCallReported[key]=true;this.capture('$feature_flag_called',{$feature_flag:key,$feature_flag_response:response});}return response;}},{key:"getFeatureFlags",value:function getFeatureFlags(){var flags=this.getPersistedProperty(_types.PostHogPersistedProperty.FeatureFlags);var overriddenFlags=this.getPersistedProperty(_types.PostHogPersistedProperty.OverrideFeatureFlags);if(!overriddenFlags){return flags;}flags=flags||{};for(var key in overriddenFlags){if(!overriddenFlags[key]){delete flags[key];}else{flags[key]=overriddenFlags[key];}}return flags;}},{key:"isFeatureEnabled",value:function isFeatureEnabled(key){var response=this.getFeatureFlag(key);if(response===undefined){return undefined;}return!!response;}},{key:"reloadFeatureFlagsAsync",value:function(){var _reloadFeatureFlagsAsync=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee2(){var sendAnonDistinctId,_args2=arguments;return _regenerator["default"].wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:sendAnonDistinctId=_args2.length>0&&_args2[0]!==undefined?_args2[0]:true;_context2.next=3;return this.decideAsync(sendAnonDistinctId);case 3:return _context2.abrupt("return",_context2.sent.featureFlags);case 4:case"end":return _context2.stop();}}},_callee2,this);}));function reloadFeatureFlagsAsync(){return _reloadFeatureFlagsAsync.apply(this,arguments);}return reloadFeatureFlagsAsync;}()},{key:"onFeatureFlags",value:function onFeatureFlags(cb){var _this3=this;return this.on('featureflags',(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee3(){var flags;return _regenerator["default"].wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:flags=_this3.getFeatureFlags();if(flags){cb(flags);}case 2:case"end":return _context3.stop();}}},_callee3);})));}},{key:"onFeatureFlag",value:function onFeatureFlag(key,cb){var _this4=this;return this.on('featureflags',(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee4(){var flagResponse;return _regenerator["default"].wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:flagResponse=_this4.getFeatureFlag(key);if(flagResponse!==undefined){cb(flagResponse);}case 2:case"end":return _context4.stop();}}},_callee4);})));}},{key:"overrideFeatureFlag",value:function overrideFeatureFlag(flags){if(flags===null){return this.setPersistedProperty(_types.PostHogPersistedProperty.OverrideFeatureFlags,null);}return this.setPersistedProperty(_types.PostHogPersistedProperty.OverrideFeatureFlags,flags);}},{key:"_sendFeatureFlags",value:function _sendFeatureFlags(event,properties){var _this5=this;this.reloadFeatureFlagsAsync(false)["finally"](function(){var payload=_this5.buildPayload({event:event,properties:properties});_this5.enqueue('capture',payload);});}},{key:"enqueue",value:function enqueue(type,_message){var _this6=this;if(this.optedOut){return;}var message=_objectSpread(_objectSpread({},_message),{},{type:type,library:this.getLibraryId(),library_version:this.getLibraryVersion(),timestamp:_message.timestamp?_message.timestamp:(0,_utils.currentISOTime)()});if(type==="capture"){console.log("Previous timestamp - ",message.timestamp);if(_message.properties&&_message.properties.timestamp)message.timestamp=_message.properties.timestamp;console.log("New timestamp - ",message.timestamp);}if(message.distinctId){message.distinct_id=message.distinctId;delete message.distinctId;}var queue=this.getPersistedProperty(_types.PostHogPersistedProperty.Queue)||[];queue.push({message:message});this.setPersistedProperty(_types.PostHogPersistedProperty.Queue,queue);this._events.emit(type,message);if(queue.length>=this.flushAt){this.flush();}if(this.flushInterval&&!this._flushTimer){this._flushTimer=(0,_utils.safeSetTimeout)(function(){return _this6.flush();},this.flushInterval);}}},{key:"flushAsync",value:function flushAsync(){var _this7=this;return new Promise(function(resolve,reject){_this7.flush(function(err,data){return err?reject(err):resolve(data);});});}},{key:"flush",value:function flush(callback){var _this8=this;if(this.optedOut){return callback===null||callback===void 0?void 0:callback();}if(this._flushTimer){clearTimeout(this._flushTimer);this._flushTimer=null;}var queue=this.getPersistedProperty(_types.PostHogPersistedProperty.Queue)||[];if(!queue.length){return callback===null||callback===void 0?void 0:callback();}var items=queue.splice(0,this.flushAt);this.setPersistedProperty(_types.PostHogPersistedProperty.Queue,queue);var messages=items.map(function(item){return item.message;});var data={api_key:this.apiKey,batch:messages,sent_at:(0,_utils.currentISOTime)()};var done=function done(err){callback===null||callback===void 0?void 0:callback(err,messages);_this8._events.emit('flush',messages);};var customUserAgent=this.getCustomUserAgent();var headers={};if(customUserAgent){headers['user-agent']=customUserAgent;}var payload=JSON.stringify(data);var url=this.captureMode==='form'?"".concat(this.host,"/e/?ip=1&_=").concat((0,_utils.currentTimestamp)(),"&v=").concat(this.getLibraryVersion()):"".concat(this.host,"/batch/");var fetchOptions=this.captureMode==='form'?{method:'POST',mode:'no-cors',credentials:'omit',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:"data=".concat(encodeURIComponent(_lzString.LZString.compressToBase64(payload)),"&compression=lz64")}:{method:'POST',headers:{'Content-Type':'application/json'},body:payload};this.fetchWithRetry(url,fetchOptions).then(function(){return done();})["catch"](function(err){if(err.response){var error=new Error(err.response.statusText);return done(error);}done(err);});}},{key:"fetchWithRetry",value:function(){var _fetchWithRetry=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee5(url,options,retryOptions){var _this9=this;var _a,_b;return _regenerator["default"].wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:;(_a=(_b=AbortSignal).timeout)!==null&&_a!==void 0?_a:_b.timeout=function timeout(ms){var ctrl=new AbortController();setTimeout(function(){return ctrl.abort();},ms);return ctrl.signal;};return _context5.abrupt("return",(0,_utils.retriable)(function(){return _this9.fetch(url,_objectSpread({signal:AbortSignal.timeout(_this9.requestTimeout)},options));},retryOptions||this._retryOptions));case 3:case"end":return _context5.stop();}}},_callee5,this);}));function fetchWithRetry(_x,_x2,_x3){return _fetchWithRetry.apply(this,arguments);}return fetchWithRetry;}()},{key:"shutdownAsync",value:function(){var _shutdownAsync=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee6(){return _regenerator["default"].wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:clearTimeout(this._flushTimer);_context6.next=3;return this.flushAsync();case 3:case"end":return _context6.stop();}}},_callee6,this);}));function shutdownAsync(){return _shutdownAsync.apply(this,arguments);}return shutdownAsync;}()},{key:"shutdown",value:function shutdown(){void this.shutdownAsync();}}]);return PostHogCore;}();exports.PostHogCore=PostHogCore;